# 📆 2024-12-17

# 🔔 스크럼

- 학습 목표 1 : VPC
<br/>

# 🚀 Today I Learned

VPC는 **퍼블릭 클라우드 환경에서 독립적인 가상의 네트워크 공간**으로 사용자의 설정에 따라 자유롭게 구성할 수 있다.

VPC가 없다면 EC2 인스턴스들이 서로 거미줄처럼 단일 네트워크에 연결된다. 이러한 구조는 하나의 EC2 인스턴스만 추가되어도 모든 인스턴스를 수정해야 하는 불편함이 생기기 때문에 **시스템의 복잡도가 매우 높아진다**.

VPC를 적용함으로써 **VPC 별로 네트워크를 구성**할 수 있고 각각의 VPC는 완전히 **독립된 네트워크**처럼 작동하게 된다.


### VPC 구축

VPC는 RFC1918 이라는 **Private IP 대역**에 맞추어 구축해야 한다고 한다. 여기서 Private IP는 인터넷 통신을 위해 사용하는 것이 아닌 로컬 네트워크 통신을 위해 사용하는 IP 주소이다. 

VPC에서 사용하는 Private IP 대역은 다음과 같다.
- 10.0.0.0/8 (10.0.0.0 - 10.255.255.255)
- 172.16.0.0/12 (172.16.0.0 - 172.31.255.255)
- 192.168.0.0/16 (192.168.0.0 - 192.168.255.255)

VPC에 한번 IP 대역이 설정되면 이후 수정할 수 없고, VPC는 **하나의 리전에 종속**된다.

### 서브넷

서브넷은 VPC를 **더 작은 네트워크 단위로 나눈 것**이다. 따라서, 서브넷 마스크가 더 높고 더 작은 아이피 범위를 갖는다.

서브넷은 더 많은 네트워크를 만들기 위해서 사용한다. 네트워크가 많아질수록 다음과 같은 이점이 있다.

1. 네트워크 트래픽 감소 : 브로드캐스트 트래픽이 각 서브넷 내로 제한된다.
2. 보안 강화 : 중요한 데이터가 포함된 서브넷에 대한 접근 제한을 설정
3. 네트워크 관리 용이 : 필요에 따라 네트워크를 나눔으로써, 불필요한 IP 낭비를 방지 

서브넷은 두 가지 유형으로 나뉜다.
- 퍼블릭 서브넷 : 인터넷 게이트웨이를 통해 **외부와 통신이 가능한 서브넷**
- 프라이빗 서브넷 : 인터넷 게이트웨이와 연결되지 않아 **외부와 직접 통신이 불가능한 서브넷**

### 라우터와 라우팅 테이블

![](https://miro.medium.com/v2/resize:fit:1100/format:webp/1*C_j93s0KB4JwfLgck5YFug.png)

서브넷 간 트래픽 전달이 필요할 경우 **라우팅 기능은 필수**적이다. 라우터는 목적지이고 라우팅 테이블은 목적지에 대한 이정표이다.

즉, 데이터는 라우터로 향하게 되며 네트워크 요청은 각각 정의된 라우팅 테이블에 따라 작동한다.

서브넷 A 라우팅 테이블은 목적지의 주소가 172.31.0.0/16인 즉, VPC 안의 네트워크 범위를 갖는 네트워크 요청은 로컬에서 찾도록 설정되어 있다.

그러나, 외부로 나가는 트래픽은 처리할 수 없다. 이때 인터넷 게이트웨이를 사용한다.

### 인터넷 게이트웨이

![](https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I_3RxWyOPMj9lQs1xhEebg.png)

인터넷 게이트웨이는 **VPC와 인터넷을 연결해주는 라우터**이다.

서브넷 B 라우팅 테이블은 목적지의 주소가 0.0.0.0/0인 즉, **모든 IPv4 요청에 대해 인터넷 게이트웨이 A로 보내도록 설정**되어 있다.

라우팅 테이블은 목적지의 주소가 172.31.0.0/16에 매칭되는지 확인한 후 매칭되지 않는다면 IGA A로 보내게 된다.

인터넷과 연결되어 있는 서브넷을 퍼블릭 서브넷, 인터넷과 연결되어 있지 않은 서브넷을 프라이빗 서브넷이라고 한다.


### 네트워크 ACL과 보안그룹

네트워크 ACL과 보안그룹은 **네트워크 보안 설정**을 위해 사용된다. 모두 **네트워크 트래픽을 필터링**하지만, 동작 방식에 차이가 있다.

**[네트워크 ACL]** - 서브넷 수준

1. 규칙 기반 필터링 : ACL 규칙은 **숫자 순서에 따라 평가**되며, 첫 번째 일치하는 규칙이 적용된다.
2. Stateless : 인바운드와 아웃바운드 트래픽에 대해 **각각 명시적으로 허용/거부 규칙을 설정**해야 한다.
3. 기본 거부 : 모든 트래픽에 대해 **기본 거부 규칙이 설정**되어 있다.

**[보안그룹]** - 인스턴스 수준

1. 허용 규칙만 설정 : 모든 트래픽은 **기본적으로 차단**되며 **명시적으로 허용된 트래픽만 통과**할 수 있다.
2. Stateful : 인바운드 트래픽을 허용하면 **해당 트래픽의 응답은 자동으로 허용**된다.

네트워크 ACL과 보안그룹이 충돌할 경우 보안그룹이 더 높은 우선순위를 갖는다고 한다.

### NAT 게이트웨이

NAT 게이트웨이는 프라이빗 서브넷이 인터넷과 통신하기 위한 아웃바운드 인스턴스이다.

주로 인스턴스의 펌웨어나 주기적인 업데이트가 필요하여 **아웃바운드 트래픽만 허용**되어야할 경우 사용된다. 

**퍼블릭 서브넷 상에서 동작**하는 NAT 게이트웨이는 프라이빗 서브넷에서 외부로 요청하는 아웃 바운드 트래픽을 받아 인터넷 게이트웨이와 연결한다.

## Reference

https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098

# 🔥 오늘의 도전 과제와 해결 방법

- VPC에 대해서 학습

<br/>

# 🗨️ 오늘의 회고
- 배포 과제 전 VPC에 대해서 학습 

<!--
- 오늘의 학습 경험에 대한 자유로운 생각이나 느낀 점을 기록합니다.
- 성공적인 점, 개선해야 할 점, 새롭게 시도하고 싶은 방법 등을 포함할 수 있습니다.-->
