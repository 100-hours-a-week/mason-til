# 📆 2024-11-27

# 🔔 스크럼

- 학습 목표 1 : SSL, TLS, HTTPS
<br/>

# 🚀 Today I Learned

## SSL와 TSL


SSL(Secure Sockets Layer)와 TLS(Transport Layer Security)는 **인터넷 상에서 데이터를 안전하게 전송하기 위해 사용되는 암호화 프로토콜**이다.

SSL은 초기 버전의 암호화 프로토콜이며, TLS는 SSL의 **보안 취약점과 성능을 개선한 버전**이다. 현재 대부분의 인터넷 통신에서는 TLS를 사용한다.

TLS는 다음과 같은 세 가지 보안 목표를 달성함으로써, 안전하지 않은 인터넷에서 안전한 통신 채널을 만들 수 있다.

**1. 인증성(Authenticity)**

클라이언트/서버가 통신하려는 **상대방이 제 3자가 아님을 인증**하는 것

**2. 기밀성(Confidentiality)** 

**클라이언트와 서버만이 서로가 주고받는 데이터를 읽을 수 있고**, 그 외 제 3자는 불가능하게 하는 것

**3. 무결성(Integrity)**

클라이언트/서버가 보내는 **데이터가 변조되지 않았음을 보장**하는 것


### Cipher Suite

```
TLS_{키 합의 프로토콜}_{인증 방법}_WITH_{암호화 기법}_{데이터 무결성 체크 방법}
```


TLS는 안전한 통신을 위해 **보안 목표를 달성할 수 있는 암호화 기법을 여러 가지 조합**하여 암호화 모음을 만든다. 이 암호화 모음을 Cipher Suite라고 한다.

클라이언트와 서버는 적절한 Cipher Suite를 선택하면, 세 가지 보안 목표를 달성할 수 있다.

- 인증성 → 인증 방법 (e.g. RSA)
- 기밀성 → 암호화 기법 (e.g. AES_256_DBC)
- 무결성 → 데이터 무결성 체크 방법 (e.g. SHA256) 


## HTTPS


HTTPS(HyperText Transfer Protocol Secure)는 **HTTP 프로토콜에 SSL/TLS 암호화를 적용**하여 보안을 강화한 프로토콜이다.

즉, HTTPS는 HTTP를 기반으로 통신하지만 **암호화를 위한 별도의 협의 과정(TLS Handshake)**을 거쳐야하는 프로토콜이다.


### 대칭 키 암호화 방식

![text](https://cdn-images-1.medium.com/max/1600/0*FqRQW2Sffylf_lbR)


대칭 키 암호화 방식은 **하나의 키를 사용하여 데이터를 암호화하고 복호화**하는 암호화 방식이다. 이때 클라이언트와 서버는 **동일한 키를 공유**해야 하고 이 키는 외부에 노출되어서는 안된다. 대표적으로 AES가 있다.

대칭 키 암호화는 **암호화/복호화 수행 속도가 빠르다**는 장점이 있고, 키를 가지고 있는 쪽에서만 암호화/복호화를 할 수 있다는 점에서 기밀성, 약간의 인증성을 보장할 수 있다.

### 공개 키 암호화 방식

![](https://cdn-images-1.medium.com/max/1600/0*zd4M7KS7XSUtHKmd)

공개 키 암호화 방식은 **비대칭 키 암호화 방식**으로도 불리며, **두 개의 키(공개 키와 개인 키)를 사용하여 데이터를 암호화하고 복호화**하는 암호화 방식이다. 대표적으로 RSA가 있다.

HTTPS에서 공개 키 암호화는 **암호화/복호화에 드는 비용이 크기** 때문에 일반적인 암호화 통신보다는 **실제 암호화에 사용할 세션 키(대칭 키)를 교환**할 때 주로 사용된다.

## HTTPS 통신 과정

### 전체 프로세스

![](https://cdn-images-1.medium.com/max/1600/0*8YclDbTxqj9B9kDd)


1. 서버는 한 쌍의 공개 키와 개인 키를 생성한 뒤, 서버의 각종 정보와 공개 키를 인증기관(CA)에 전달하여 **SSL/TLS 인증서 생성을 요청**한다.

2. 인증기관(CA)는 서버로부터 받은 요청을 확인하고 검증이 완료되면, **SSL/TLS 인증서를 생성**한다. 이때 인증서에는 다음과 같은 정보들이 포함된다.

- 서버의 공개 키
- 서버 도메인 정보

  이후 인증기관은 한 쌍의 공개 키와 개인 키를 생성하고 **개인 키로 SSL/TLS 인증서에 디지털 서명을 추가**한 뒤 서버에게 반환한다. 서버는 이를 전달받고 게시한다.

3. 브라우저는 서버로부터 SSL/TLS 인증서를 전달받고 해당 인증서를 검증한다. 이때 브라우저는 **인증기관(CA)의 공개 키를 사용**한다. 검증 과정에서는 다음 항목들을 확인한다.

- 인증서의 서명이 CA의 공개 키로 검증되는지
- 인증서의 도메인이 요청한 도메인과 일치하는지
- 인증서의 유효 기간 확인

4. 인증서 검증이 성공하면 **브라우저는 서버를 신뢰**하고, 전달받은 인증서에 포함된 **실제 데이터 암호화에 사용할 세션 키(대칭 키)를 생성한 뒤 서버의 공개 키로 이를 암호화하여 서버에 전달**한다.

5. 서버는 브라우저가 전달한 **세션 키를 서버의 개인 키로 복호화**함으로써, 브라우저와 서버는 동일한 세션 키를 가지게 된다. 이후 **브라우저와 서버 간의 데이터 교환은 세션 키 암호화를 통해 수행**된다.


## TLS Handshake

TLS Handshake는 클라이언트와 서버가 **실제 암호화 통신을 하기 위해 서로 인증하고 암호화 키를 교환**하는 과정이다. 

즉, 서로의 신원을 파악하고, 사용할 Cipher Suite를 선택하며, 실제 데이터를 암호화/복호화할 세션 키를 생성함으로써 TLS 보안 채널을 만들어가는 과정이다.

이후 만들어진 TLS 보안 채널을 통해 암호화/복호화를 진행하면서 데이터를 주고받을 수 있게 된다.

### TLS 1.2 버전

![text](https://cdn-images-1.medium.com/max/1600/0*Vp5YBSfbOdKCA7eY)


Client Hello 단계에서 클라이언트는 **자신이 사용할 TLS 버전, 사용 가능한 Cipher Suite를 서버에 전송**한다.

Server Hello 단계에서 서버는 **클라이언트의 Cipher Suite 중 하나를 선택하고 서버의 인증서와 함께 클라이언트에 전송**한다.

ClientKeyExchange 단계에서 클라이언트는 **서버의 인증서를 검증**하고 **세션 키를 생성한 뒤 서버의 공개 키로 암호화해서 서버에 전달**한다.

ChangeCipherSpec은 이후 보낼 모든 메시지가 암호화될 것임을 상대에게 알리는 용도이다.

이때 세션 키 교환은 RSA 방식으로 수행된다. RSA 방식은 **개인 키가 유출될 경우 그 동안의 통신이 모두 노출될 위험**이 있다.

![text](https://cdn-images-1.medium.com/max/1600/0*HBO_GA0lFw0STHhh)

### TLS 1.3 버전

![alt text](https://www.appviewx.com/wp-content/uploads/2022/03/Improved-Performance-and-Efficiency.png)


TLS 1.3은 **RTT(Round Trip Time, 요청 후 응답까지 걸리는 시간)를 줄여 속도를 개선**했다. 

Handshake는 크게 처음 연결하는 경우와 재연결하는 경우로 나뉘는데, TLS 1.3은 처음 연결 시 1-RTT를 소요하고, 재연결 시에는 0-RTT를 소요한다

![text](https://cdn-images-1.medium.com/max/1600/0*c41cwd4iFvrDBNI-)

또한, TLS 1.3은 **Diffie-Hellman 키 교환 알고리즘을 통해 보안 문제점도 개선**했다.

이 방식은 **세션 키를 만들 수 있는 힌트만을 제공하기 때문에 복호화가 불가능**하다.

우선 클라이언트와 서버는 통신에 사용할 공개 키(노랑)를 정한다. 이후 각각 임시 개인 키(클라이언트: 빨강, 서버: 청록)를 생성한다.

클라이언트와 서버 둘 다 개인 키를 전달하지 않고 **공개 키와 개인 키를 조합(클라이언트: 오렌지, 서버: 파랑)하여 서로에게 전달**한다

각자 전달받은 조합 키에 자신의 임시 개인 키를 활용하여 세션 키를 생성하고 버린다. (이후 탈취당할 가능성을 배제하기 위해) 


## Reference

https://yozm.wishket.com/magazine/detail/1852/

https://tech.buzzvil.com/blog/atech-blog-hello-tls-1-3/
<br/>

# 🔥 오늘의 도전 과제와 해결 방법

- SSL, TLS, HTTPS 에 대해서 학습 !

<br/>

# 🗨️ 오늘의 회고



<!--
- 오늘의 학습 경험에 대한 자유로운 생각이나 느낀 점을 기록합니다.
- 성공적인 점, 개선해야 할 점, 새롭게 시도하고 싶은 방법 등을 포함할 수 있습니다.-->

